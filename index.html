<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IT Help Site ‚Äî Rowe Casa Organics</title>
  <link rel="stylesheet" href="styles.css"/>
  <style>
    :root { --sb-muted: #6a5e57; }
    html  { font-size: 17px; }

    .role-badge {
      font-size: 0.68rem; font-weight: 800; padding: 0.22rem 0.65rem;
      border-radius: 999px; letter-spacing: 0.04em; text-transform: uppercase;
      white-space: nowrap; display: none;
    }
    .role-badge[data-role]            { display: inline-block; }
    .role-badge[data-role="it_admin"] { background: rgba(46,204,138,0.15); color: #1aaf72; }

    .copy-toast {
      position: fixed; bottom: 1.75rem; left: 50%;
      transform: translateX(-50%) translateY(8px);
      background: #2ecc8a; color: #fff; font-size: 0.82rem; font-weight: 700;
      padding: 0.55rem 1.4rem; border-radius: 999px;
      box-shadow: 0 4px 16px rgba(46,204,138,0.35);
      opacity: 0; transition: opacity 0.22s, transform 0.22s;
      pointer-events: none; z-index: 900; white-space: nowrap;
    }
    .copy-toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    .portal-email-btn {
      display: block; width: 100%; background: none; border: none;
      border-radius: 8px; padding: 0.4rem 0.6rem;
      font-size: 0.67rem; color: var(--sb-muted);
      font-family: inherit; font-weight: 600; cursor: pointer;
      text-align: center; transition: all 0.18s; margin-top: 4px;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .portal-email-btn:hover { background: var(--brand-soft); color: var(--brand-brown); }

    .card-copy-btn {
      display: inline-flex; align-items: center; justify-content: center;
      background: none; border: none; color: var(--sb-muted);
      padding: 0.2rem 0.35rem; border-radius: 6px; font-size: 0.75rem;
      font-family: inherit; cursor: pointer; transition: all 0.15s; min-width: 24px;
    }
    .card-copy-btn:hover { color: var(--brand-brown); background: var(--brand-soft); }
    .card-copy-btn.disabled { opacity: 0.3; cursor: not-allowed; pointer-events: none; }

    .completed-sheet-link {
      display: none; align-items: center; gap: 0.35rem;
      font-size: 0.75rem; font-weight: 700; color: var(--brand-brown);
      text-decoration: none;
      background: var(--brand-soft); border: 1.5px solid var(--brand-hover-border);
      padding: 0.28rem 0.75rem; border-radius: 7px; transition: all 0.15s; white-space: nowrap;
    }
    .completed-sheet-link:hover { background: var(--brand-grad); color: #fff; border-color: var(--brand-brown); }
    .completed-sheet-link.visible { display: inline-flex; }

    .completed-controls {
      display: flex; align-items: center; justify-content: space-between;
      flex-wrap: wrap; gap: 0.75rem;
      margin-bottom: 1rem; padding-bottom: 1rem;
      border-bottom: 1.5px solid var(--sb-sep);
    }
    .type-tabs {
      display: inline-flex; align-items: center; gap: 0.3rem;
      background: var(--sidebar-bg); border: 1.5px solid var(--sb-border);
      border-radius: 999px; padding: 0.25rem;
    }
    .type-tab {
      padding: 0.35rem 1.1rem; border-radius: 999px; border: none;
      font-size: 0.8rem; font-weight: 700; font-family: inherit;
      cursor: pointer; transition: all 0.18s; background: none; color: var(--sb-muted);
    }
    .type-tab.active { background: var(--brand-grad); color: #fff; box-shadow: 0 2px 8px rgba(95,75,60,0.25); }

    .submissions-toggle {
      display: none; align-items: center; gap: 0.3rem;
      background: var(--sidebar-bg); border: 1.5px solid var(--sb-border);
      border-radius: 999px; padding: 0.25rem;
    }
    .submissions-toggle.visible { display: inline-flex; }
    .toggle-btn {
      padding: 0.35rem 1.1rem; border-radius: 999px; border: none;
      font-size: 0.8rem; font-weight: 700; font-family: inherit;
      cursor: pointer; transition: all 0.18s; background: none; color: var(--sb-muted);
    }
    .toggle-btn.active { background: var(--brand-grad); color: #fff; box-shadow: 0 2px 8px rgba(95,75,60,0.25); }

    .sheet-links-group { display: none; align-items: center; gap: 0.35rem; }
    .sheet-links-group.visible { display: inline-flex; }
    .sheet-links-label { font-size: 0.72rem; font-weight: 700; color: var(--sb-muted); white-space: nowrap; }

    .sub-filter-row { display: flex; align-items: center; gap: 0.4rem; flex-wrap: wrap; margin-bottom: 1.25rem; }
    .sub-filter-btn {
      padding: 0.3rem 0.9rem; border-radius: 999px;
      border: 1.5px solid var(--sb-border);
      background: var(--panel-bg); color: var(--sb-muted);
      font-size: 0.78rem; font-weight: 700; font-family: inherit;
      cursor: pointer; transition: all 0.15s;
    }
    .sub-filter-btn:hover { border-color: var(--brand-hover-border); color: var(--brand-brown); }
    .sub-filter-btn.active { background: var(--brand-soft); border-color: var(--brand-brown); color: var(--brand-brown); }

    .auth-loading {
      position: absolute; inset: 0; background: var(--panel-bg); border-radius: 16px;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      gap: 0.75rem; z-index: 50;
    }
    .auth-loading.hidden { display: none; }
    .auth-loading p { font-size: 0.85rem; color: var(--sb-muted); font-weight: 600; }

    .access-notice {
      background: var(--sidebar-bg); border: 1.5px solid var(--sb-border);
      border-radius: 12px; padding: 2rem; text-align: center;
      color: var(--sb-muted); font-size: 0.875rem; display: none;
    }
    .access-notice.show { display: block; }

    /* Contact Guide Modal */
    .cg-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.48);
      backdrop-filter: blur(7px); z-index: 600;
      display: flex; align-items: center; justify-content: center; padding: 1rem;
    }
    .cg-overlay.hidden { display: none; }
    .cg-box {
      background: var(--panel-bg); border: 1.5px solid var(--sb-border);
      border-radius: 20px; padding: 2rem 2.25rem;
      max-width: 620px; width: 100%; max-height: 88vh; overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.22);
    }
    .cg-box h2 { font-size: 1.2rem; font-weight: 800; color: var(--sb-text); margin-bottom: 0.3rem; }
    .cg-sub    { font-size: 0.85rem; color: var(--sb-muted); line-height: 1.6; margin-bottom: 1.5rem; }
    .cg-section { margin-bottom: 1.5rem; }
    .cg-section-title {
      font-size: 0.72rem; font-weight: 800; text-transform: uppercase;
      letter-spacing: 0.07em; color: var(--sb-muted);
      margin-bottom: 0.65rem; padding-bottom: 0.4rem; border-bottom: 1px solid var(--sb-sep);
    }
    .cg-methods { display: flex; flex-direction: column; gap: 0.5rem; }
    .cg-method {
      display: flex; align-items: center; gap: 0.85rem;
      background: var(--sidebar-bg); border: 1.5px solid var(--sb-border);
      border-radius: 11px; padding: 0.75rem 1rem;
    }
    .cg-method-icon {
      font-size: 1.25rem; flex-shrink: 0; width: 36px; height: 36px;
      background: var(--brand-soft); border-radius: 9px;
      display: flex; align-items: center; justify-content: center;
    }
    .cg-method-text strong { display: block; font-size: 0.88rem; color: var(--sb-text); font-weight: 700; }
    .cg-method-text span   { font-size: 0.8rem; color: var(--sb-muted); line-height: 1.5; }
    .cg-method-text a      { color: var(--brand-brown); font-weight: 700; text-decoration: none; }
    .cg-method-text a:hover { text-decoration: underline; }
    .cg-emergency {
      background: rgba(220,80,60,0.07); border: 1.5px solid rgba(220,80,60,0.28);
      border-radius: 12px; padding: 1rem 1.25rem;
    }
    .cg-emergency-head  { font-size: 0.92rem; font-weight: 800; color: #c0392b; margin-bottom: 0.55rem; }
    .cg-emergency-phone { font-size: 1.05rem; font-weight: 800; color: #c0392b; margin-bottom: 0.65rem; }
    .cg-emergency ul    { padding-left: 1.1rem; margin: 0; display: flex; flex-direction: column; gap: 0.3rem; }
    .cg-emergency ul li { font-size: 0.82rem; color: #8b2a1f; line-height: 1.5; }
    .cg-include-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.45rem; }
    @media(max-width:520px){ .cg-include-grid,.cg-examples,.cg-split { grid-template-columns: 1fr; } }
    .cg-include-item {
      display: flex; align-items: flex-start; gap: 0.5rem;
      background: var(--sidebar-bg); border: 1px solid var(--sb-border);
      border-radius: 9px; padding: 0.55rem 0.75rem;
      font-size: 0.8rem; color: var(--sb-text); line-height: 1.45;
    }
    .cg-include-item::before { content:'‚úì'; color: var(--success); font-weight: 800; font-size: 0.78rem; flex-shrink: 0; margin-top: 0.05rem; }
    .cg-examples { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .cg-ex-card { border-radius: 11px; padding: 0.9rem 1rem; border: 1.5px solid; }
    .cg-ex-good { background: var(--success-soft); border-color: rgba(46,204,138,0.3); }
    .cg-ex-bad  { background: rgba(220,80,60,0.06); border-color: rgba(220,80,60,0.22); }
    .cg-ex-label { font-size: 0.68rem; font-weight: 800; text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 0.45rem; }
    .cg-ex-good .cg-ex-label { color: var(--success); }
    .cg-ex-bad  .cg-ex-label { color: #c0392b; }
    .cg-ex-card p  { font-size: 0.78rem; color: var(--sb-text); line-height: 1.55; margin: 0; }
    .cg-ex-why     { font-size: 0.73rem; color: var(--sb-muted); margin-top: 0.45rem; font-style: italic; }
    .cg-split { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .cg-split-card   { border-radius: 11px; padding: 0.9rem 1rem; border: 1.5px solid; }
    .cg-split-ticket { background: var(--success-soft); border-color: rgba(46,204,138,0.3); }
    .cg-split-call   { background: rgba(220,80,60,0.06); border-color: rgba(220,80,60,0.22); }
    .cg-split-head   { font-size: 0.78rem; font-weight: 800; margin-bottom: 0.5rem; }
    .cg-split-ticket .cg-split-head { color: var(--success); }
    .cg-split-call   .cg-split-head { color: #c0392b; }
    .cg-split-card ul    { padding-left: 1rem; margin: 0; display: flex; flex-direction: column; gap: 0.3rem; }
    .cg-split-card ul li { font-size: 0.79rem; color: var(--sb-text); line-height: 1.45; }
    .cg-bfcm {
      background: linear-gradient(135deg, #5f4b3c 0%, #8d8173 100%);
      border-radius: 12px; padding: 1rem 1.25rem;
      display: flex; gap: 0.75rem; align-items: flex-start;
    }
    .cg-bfcm-icon { font-size: 1.3rem; flex-shrink: 0; }
    .cg-bfcm-text strong { display: block; font-size: 0.9rem; color: #fff; font-weight: 800; margin-bottom: 0.25rem; }
    .cg-bfcm-text span   { font-size: 0.8rem; color: rgba(255,255,255,0.82); line-height: 1.5; }
    .cg-close {
      width: 100%; margin-top: 1.5rem; padding: 0.7rem;
      background: var(--brand-grad); color: #fff; border: none;
      border-radius: 10px; font-size: 0.9rem; font-weight: 700;
      font-family: inherit; cursor: pointer; transition: opacity 0.18s;
    }
    .cg-close:hover { opacity: 0.88; }
  </style>
</head>
<body>

  <div class="app-shell">

    <aside class="sidebar">
      <div class="sidebar-logo-wrap">
        <img src="logo.png" alt="Rowe Casa Organics" class="sidebar-logo"/>
      </div>
      <div class="sidebar-divider"></div>
      <nav class="sidebar-nav">
        <button class="nav-btn active" data-section="surveys"><span class="nav-icon">üìã</span> Surveys</button>
        <button class="nav-btn" data-section="forms"><span class="nav-icon">üìù</span> Request Forms</button>
        <button class="nav-btn" data-section="completed"><span class="nav-icon">‚úÖ</span> Completed</button>
      </nav>
      <div class="sidebar-footer">
        <button class="nav-btn" data-section="knowledge" style="margin-bottom:8px">
          <span class="nav-icon"></span> IT Knowledge Base
        </button>
        <div class="sidebar-divider"></div>
        <button class="contact-btn" data-section="contact">‚úâÔ∏è Contact Us</button>
        <button class="portal-email-btn"
                title="Email itsupport@rowecasaorganics.com"
                onclick="window.open('https://mail.google.com/mail/?view=cm&fs=1&to=itsupport%40rowecasaorganics.com','_blank')">
          itsupport@rowecasaorganics.com
        </button>
      </div>
    </aside>

    <div class="main-wrap">
      <header class="topbar">
        <div class="topbar-left">
          <div class="topbar-title">Welcome to the RCO IT Help Site</div>
          <div class="topbar-desc">Submit surveys, request IT support, or reach out to our team directly.</div>
        </div>
        <div class="topbar-right">
          <span class="role-badge" id="roleBadge"></span>
          <span class="topbar-user" id="topbarUser">Not signed in</span>
          <button class="sign-btn" id="authBtn">Sign Out</button>
        </div>
      </header>

      <main class="content-panel" style="position:relative">

        <div class="auth-loading" id="authLoading">
          <div class="login-spinner"></div>
          <p>Loading your portal...</p>
        </div>

        <!-- ‚îÄ‚îÄ SURVEYS ‚îÄ‚îÄ -->
        <section class="section active" id="section-surveys">
          <div class="section-intro">
            <h2>IT Surveys</h2>
            <p>Complete your assigned surveys to help our team manage technology across the organization.</p>
            <p style="font-size:0.78rem;color:var(--sb-muted);margin-top:0.35rem">Feel free to resubmit anytime ‚Äî each submission is saved separately.</p>
          </div>
          <div class="cards">
            <div class="card brown" data-content-id="tech-discovery" style="display:none">
              <div class="card-top"><span class="card-status status-active">Active</span></div>
              <h3>RCO IT Software Inventory</h3>
              <p>Help us build a complete inventory of every tool, app, SaaS platform, and account used across your department.</p>
              <div class="card-meta">
                <div class="card-meta-left">
                  <span class="meta-label">Est. completion time</span>
                  <span class="meta-value">10 ‚Äì 15 mins</span>
                </div>
                <div style="display:flex;align-items:center;gap:0.5rem">
                  <button class="card-copy-btn"
                          onclick="copyLink(getSurveyUrl('surveys/tech-discovery.html'), this)"
                          title="Copy a direct link to this survey">üîó</button>
                  <button class="card-action" id="startSurveyBtn">Start ‚Üí</button>
                </div>
              </div>
            </div>
          </div>
          <div class="access-notice" id="surveysAccessNotice">
            No surveys are currently assigned to your role. Check back soon or contact IT if you think this is an error.
          </div>
        </section>

        <!-- ‚îÄ‚îÄ FORMS ‚îÄ‚îÄ -->
        <section class="section" id="section-forms">
          <div class="section-intro">
            <h2>Request Forms</h2>
            <p>Submit IT requests for new employees, departing staff, or equipment and software needs.</p>
            <p style="font-size:0.78rem;color:var(--sb-muted);margin-top:0.35rem">Feel free to resubmit anytime ‚Äî each submission is saved separately.</p>
          </div>
          <div class="cards">

            <div class="card brown" data-content-id="onboarding" style="display:none">
              <div class="card-top"><span class="card-status status-active">Active</span></div>
              <h3>User Onboarding Request</h3>
              <p>Submit everything IT needs to provision a new employee ‚Äî role, system access, devices, and software requirements.</p>
              <div class="card-meta">
                <div class="card-meta-left">
                  <span class="meta-label">Est. completion time</span>
                  <span class="meta-value">3 ‚Äì 5 mins</span>
                </div>
                <button class="card-action" onclick="window.location.href='forms/onboarding.html'">Open Form ‚Üí</button>
              </div>
            </div>

            <div class="card brown" data-content-id="offboarding" style="display:none">
              <div class="card-top"><span class="card-status status-active">Active</span></div>
              <h3>User Offboarding Request</h3>
              <p>Capture separation details for a departing employee ‚Äî access revocation, email handling, file transfer, and device return.</p>
              <div class="card-meta">
                <div class="card-meta-left">
                  <span class="meta-label">Est. completion time</span>
                  <span class="meta-value">3 ‚Äì 5 mins</span>
                </div>
                <button class="card-action" onclick="window.location.href='forms/offboarding.html'">Open Form ‚Üí</button>
              </div>
            </div>

            <div class="card brown" data-content-id="equipment" style="display:none">
              <div class="card-top"><span class="card-status status-active">Active</span></div>
              <h3>IT Equipment &amp; Software Request</h3>
              <p>Request any technology need ‚Äî hardware, software, or licenses ‚Äî with business justification.</p>
              <div class="card-meta">
                <div class="card-meta-left">
                  <span class="meta-label">Est. completion time</span>
                  <span class="meta-value">2 ‚Äì 4 mins</span>
                </div>
                <button class="card-action" onclick="window.location.href='forms/equipment.html'">Open Form ‚Üí</button>
              </div>
            </div>

          </div>
          <div class="access-notice" id="formsAccessNotice">
            No forms are currently assigned to your role. Contact IT if you think this is an error.
          </div>
        </section>

        <!-- ‚îÄ‚îÄ COMPLETED ‚îÄ‚îÄ -->
        <section class="section" id="section-completed">
          <div class="section-intro">
            <h2>Completed Submissions</h2>
            <p>A record of surveys and forms you have submitted.</p>
          </div>
          <div class="completed-controls">
            <div style="display:flex;align-items:center;gap:0.65rem;flex-wrap:wrap">
              <div class="type-tabs">
                <button class="type-tab active" id="tabSurveys" onclick="setTypeTab('surveys')">üìã Surveys</button>
                <button class="type-tab"         id="tabForms"   onclick="setTypeTab('forms')">üìù Forms</button>
              </div>
              <div class="submissions-toggle" id="submissionsToggle">
                <button class="toggle-btn active" id="toggleMine" onclick="setSubmissionsView('mine')">My Submissions</button>
                <button class="toggle-btn"        id="toggleAll"  onclick="setSubmissionsView('all')">Everyone's</button>
              </div>
              <div class="sheet-links-group" id="sheetLinksRow-surveys">
                <span class="sheet-links-label">Sheets:</span>
                <a class="completed-sheet-link"
                   href="https://docs.google.com/spreadsheets/d/1qGufmR0KvRCU8OhQiZgf1R9CnvEvBBHogAcUh6XbOeM/edit?gid=72884401#gid=72884401"
                   target="_blank">Software Inventory</a>
              </div>
              <div class="sheet-links-group" id="sheetLinksRow-forms">
  <span class="sheet-links-label">Sheets:</span>
  <a class="completed-sheet-link" href="https://docs.google.com/spreadsheets/d/1HA_jQYKXn5X-WhcIUd79NPzR_WIzCi5y5CJ9aW7fVGk/edit?gid=1473197887#gid=1473197887"  target="_blank">Onboarding</a>
  <a class="completed-sheet-link" href="https://docs.google.com/spreadsheets/d/1HIlC6OlWtyIN8DH1kRnf0P2GBHGlHUWBJxFyllfdwjk/edit?gid=2068521876#gid=2068521876" target="_blank">Offboarding</a>
  <a class="completed-sheet-link" href="YOUR_EQUIPMENT_SHEET_URL"   target="_blank">Equipment</a>
</div>

            </div>
            <div style="display:flex;align-items:center;gap:0.65rem">
              <button class="clear-btn" style="margin:0" id="refreshBtn">‚Üª Refresh</button>
            </div>
          </div>
          <div class="sub-filter-row" id="subFilterRow"></div>
          <div id="completedSurveysList"></div>
          <div id="completedFormsList" style="display:none"></div>
        </section>

        <!-- ‚îÄ‚îÄ KNOWLEDGE BASE ‚îÄ‚îÄ -->
        <section class="section" id="section-knowledge">
          <div class="section-intro">
            <h2>IT Knowledge Base</h2>
            <p>Guides, how-tos, and IT documentation for the RCO team.</p>
          </div>
          <div class="construction-wrap">
            <div class="construction-badge">
              <div class="construction-emoji">üöß</div>
              <span class="construction-tag">Coming Soon</span>
              <h2>Under Construction</h2>
              <p>The IT Knowledge Base is being built out. Check back soon for guides, FAQs, and documentation.</p>
            </div>
          </div>
        </section>

        <!-- ‚îÄ‚îÄ CONTACT ‚îÄ‚îÄ -->
        <section class="section" id="section-contact">
          <div class="section-intro">
            <h2>Contact IT Support</h2>
            <p>Reach out to the RCO IT team ‚Äî use the form below to compose a message, or email us directly.</p>
          </div>
          <div style="background:var(--sidebar-bg);border:1.5px solid var(--sb-border);border-radius:14px;
                      padding:1.25rem 1.5rem;margin-bottom:1.25rem;max-width:580px">
            <h3 style="font-size:0.88rem;font-weight:800;color:var(--sb-text);margin-bottom:0.6rem">How to Contact IT</h3>
            <p style="font-size:0.875rem;color:var(--sb-muted);line-height:1.7;margin-bottom:0.9rem">
              For general IT support, questions, or requests, the best way to reach us is by submitting a ticket or
              emailing us directly. We typically respond within one business day.
            </p>
            <button onclick="document.getElementById('cgModal').classList.remove('hidden')"
                    style="display:inline-flex;align-items:center;gap:0.45rem;
                           background:var(--brand-soft);border:1.5px solid var(--brand-hover-border);
                           color:var(--brand-brown);padding:0.5rem 1.1rem;border-radius:9px;
                           font-size:0.875rem;font-weight:700;font-family:inherit;cursor:pointer;transition:all 0.15s"
                    onmouseover="this.style.background='var(--brand-grad)';this.style.color='#fff';this.style.borderColor='var(--brand-brown)'"
                    onmouseout="this.style.background='var(--brand-soft)';this.style.color='var(--brand-brown)';this.style.borderColor='var(--brand-hover-border)'">
              üìã How to Contact IT ‚Äî Full Guide
            </button>
          </div>
          <div class="contact-form-wrap">
            <div class="contact-field">
              <label for="contactFrom">Your Email Address</label>
              <input type="email" id="contactFrom" placeholder="yourname@rowecasaorganics.com"/>
            </div>
            <div class="contact-field">
              <label for="contactTo">To</label>
              <input type="text" id="contactTo" value="itsupport@rowecasaorganics.com" readonly/>
            </div>
            <div class="contact-field">
              <label for="contactSubject">Subject</label>
              <input type="text" id="contactSubject" placeholder="Brief description of your issue or request"/>
            </div>
            <div class="contact-field">
              <label for="contactBody">Message</label>
              <textarea id="contactBody" rows="6" placeholder="Describe your issue, request, or question in detail..."></textarea>
            </div>
            <div class="contact-actions">
              <button class="card-action" id="sendBtn">Send Message ‚Üí</button>
              <button class="clear-btn" id="clearBtn">Clear</button>
            </div>
            <div id="contactStatus" class="contact-status"></div>
          </div>
        </section>

      </main>
    </div>
  </div>

  <div id="copyToast" class="copy-toast">üîó Link copied to clipboard!</div>

  <!-- How to Contact IT Modal -->
  <div class="cg-overlay hidden" id="cgModal" onclick="if(event.target===this)this.classList.add('hidden')">
    <div class="cg-box">
      <h2>How to Contact IT</h2>
      <p class="cg-sub">We use tickets to ensure every issue is tracked, prioritized, and handled by the right person ‚Äî without anything slipping through the cracks.</p>
      <div class="cg-section">
        <div class="cg-section-title">‚úÖ Preferred Methods ‚Äî Each creates a ticket automatically</div>
        <div class="cg-methods">
          <div class="cg-method"><div class="cg-method-icon">‚úâÔ∏è</div><div class="cg-method-text"><strong>Email</strong><span><a href="mailto:itsupport@rowecasaorganics.com">itsupport@rowecasaorganics.com</a></span></div></div>
          <div class="cg-method"><div class="cg-method-icon">üåê</div><div class="cg-method-text"><strong>IT Portal</strong><span><a href="https://it.rowecasaorganics.com" target="_blank">it.rowecasaorganics.com</a></span></div></div>
          <div class="cg-method"><div class="cg-method-icon">üí¨</div><div class="cg-method-text"><strong>Slack</strong><span>#rco-it-support</span></div></div>
          <div class="cg-method"><div class="cg-method-icon">üñ•Ô∏è</div><div class="cg-method-text"><strong>System Tray Ticket Form</strong><span>Click the RCO IT Agent icon near the clock ‚Üí select <em>IT Ticket Form</em> ‚Üí fill in details ‚Üí Save.</span></div></div>
        </div>
      </div>
      <div class="cg-section">
        <div class="cg-section-title">üö® Emergencies ‚Äî Critical Issues Only</div>
        <div class="cg-emergency">
          <div class="cg-emergency-head">üìû IT Emergency Line</div>
          <div class="cg-emergency-phone">469-893-1998</div>
          <p style="font-size:0.8rem;color:#8b2a1f;margin-bottom:0.6rem;line-height:1.5">Use this only for true critical events:</p>
          <ul>
            <li>Internet or network outage ‚Äî wait ~5‚Äì10 minutes first</li>
            <li>Major system failure where nobody can work</li>
            <li>Any cybersecurity event (suspected hacking, phishing link clicked, etc.)</li>
            <li>Production or shipping halted due to IT issues</li>
            <li>Google Workspace or Deacom outages</li>
          </ul>
        </div>
      </div>
      <div class="cg-section">
        <div class="cg-section-title">üìù What to Include in Your Ticket</div>
        <div class="cg-include-grid">
          <div class="cg-include-item">What you were trying to do</div>
          <div class="cg-include-item">What happened (describe the issue)</div>
          <div class="cg-include-item">What should have happened</div>
          <div class="cg-include-item">Any error messages (text or screenshot)</div>
          <div class="cg-include-item">Device location (Office, Warehouse, Station #)</div>
          <div class="cg-include-item">Whether others are affected</div>
          <div class="cg-include-item">Whether you've already rebooted</div>
          <div class="cg-include-item">Anyone else who needs to be notified</div>
        </div>
      </div>
      <div class="cg-section">
        <div class="cg-section-title">üß© Good vs. Bad Ticket Examples</div>
        <div class="cg-examples">
          <div class="cg-ex-card cg-ex-good">
            <div class="cg-ex-label">‚úÖ Good Ticket</div>
            <p><strong>Subject:</strong> Can't print labels on Station 14<br/><br/>While printing shipping labels in Chrome, I get "Printer unreachable." Started at 9:40 AM. Rebooted ‚Äî error persists. Model: Zebra ZD421. Station 12 still works. Screenshot attached.</p>
            <p class="cg-ex-why">Clear, detailed, and immediately actionable.</p>
          </div>
          <div class="cg-ex-card cg-ex-bad">
            <div class="cg-ex-label">‚ùå Bad Ticket</div>
            <p><strong>Subject:</strong> Printer broken<br/><br/>Printer doesn't work. Please fix ASAP.</p>
            <p class="cg-ex-why">Missing: location, device info, error details, steps already tried.</p>
          </div>
        </div>
      </div>
      <div class="cg-section">
        <div class="cg-section-title">üìû When to Ticket vs. When to Call</div>
        <div class="cg-split">
          <div class="cg-split-card cg-split-ticket">
            <div class="cg-split-head">‚úÖ Submit a Ticket</div>
            <ul>
              <li>Issue affecting one or a few users</li>
              <li>Multi-user issue with a workaround available</li>
              <li>General requests (equipment, software, moves)</li>
              <li>Access changes (badges, printers, permissions)</li>
              <li>General IT questions</li>
            </ul>
          </div>
          <div class="cg-split-card cg-split-call">
            <div class="cg-split-head">üö® Call Immediately</div>
            <ul>
              <li>Multiple people can't work ‚Äî no workaround</li>
              <li>Production or shipping stopped or severely slowed</li>
              <li>Entire site loses internet or network</li>
              <li>Deacom, Google Workspace, or core systems down</li>
            </ul>
          </div>
        </div>
        <p style="font-size:0.8rem;color:var(--sb-muted);margin-top:0.75rem;font-style:italic">Simple rule: If it affects everyone or critical work stops ‚Äî call us.</p>
      </div>
      <div class="cg-section" style="margin-bottom:0">
        <div class="cg-bfcm">
          <div class="cg-bfcm-icon">üî∫</div>
          <div class="cg-bfcm-text">
            <strong>BFCM Blackout ‚Äî Nov 28 ‚Äì Dec 13</strong>
            <span>All issues impacting production or shipping are escalated to high priority. Call immediately for anything affecting fulfillment during this window.</span>
          </div>
        </div>
      </div>
      <button class="cg-close" onclick="document.getElementById('cgModal').classList.add('hidden')">Got it ‚Äî Close Guide</button>
    </div>
  </div>

  <script>
    setTimeout(function() { document.getElementById('authLoading')?.classList.add('hidden'); }, 6000);
    window._submissionsView = 'mine';
    window._typeTab         = 'surveys';
    window._subFilter       = null;

    window.renderSubFilters = function(tab) {
      var row = document.getElementById('subFilterRow');
      if (!row) return;
      var cfg = window._contentConfig;
      if (!cfg) { row.innerHTML = ''; return; }
      var items = tab === 'surveys' ? cfg.surveys : cfg.forms;
      if (!items || !items.length) { row.innerHTML = ''; return; }
      var html = '';
      if (items.length > 1) html += '<button class="sub-filter-btn' + (!window._subFilter ? ' active' : '') + '" onclick="setSubFilter(null)">All</button>';
      items.forEach(function(item) {
        html += '<button class="sub-filter-btn' + (window._subFilter === item.id ? ' active' : '') + '" onclick="setSubFilter(\'' + item.id + '\')">' + item.title + '</button>';
      });
      row.innerHTML = html;
    };
    window.setSubFilter = function(id) {
      window._subFilter = (window._subFilter === id) ? null : id;
      window.renderSubFilters(window._typeTab);
      if (typeof window._renderCompleted === 'function') window._renderCompleted();
    };
    function setTypeTab(tab) {
      window._typeTab = tab; window._subFilter = null;
      document.getElementById('tabSurveys').classList.toggle('active', tab === 'surveys');
      document.getElementById('tabForms').classList.toggle('active',   tab === 'forms');
      document.getElementById('completedSurveysList').style.display = tab === 'surveys' ? '' : 'none';
      document.getElementById('completedFormsList').style.display   = tab === 'forms'   ? '' : 'none';
      var sg = document.getElementById('sheetLinksRow-surveys');
      var fg = document.getElementById('sheetLinksRow-forms');
      if (sg && sg.classList.contains('visible')) sg.style.display = tab === 'surveys' ? '' : 'none';
      if (fg && fg.classList.contains('visible')) fg.style.display = tab === 'forms'   ? '' : 'none';
      window.renderSubFilters(tab);
    }
    function setSubmissionsView(mode) {
      window._submissionsView = mode;
      document.getElementById('toggleMine').classList.toggle('active', mode === 'mine');
      document.getElementById('toggleAll').classList.toggle('active',  mode === 'all');
      if (typeof window._renderCompleted === 'function') window._renderCompleted();
    }
    function getSurveyUrl(path) {
      var href = window.location.href.split('?')[0].split('#')[0];
      var base = href.endsWith('/') ? href : href.substring(0, href.lastIndexOf('/') + 1);
      return base + path;
    }
    function copyLink(url, btn) {
      var done = function() {
        showToast(); var orig = btn.innerHTML;
        btn.innerHTML = '‚úì'; btn.style.color = 'var(--success)';
        setTimeout(function() { btn.innerHTML = orig; btn.style.color = ''; }, 2000);
      };
      if (navigator.clipboard) navigator.clipboard.writeText(url).then(done).catch(function(){ fallbackCopy(url); done(); });
      else { fallbackCopy(url); done(); }
    }
    function fallbackCopy(url) {
      var el = document.createElement('textarea');
      el.value = url; el.style.position = 'fixed'; el.style.opacity = '0';
      document.body.appendChild(el); el.select(); document.execCommand('copy'); document.body.removeChild(el);
    }
    function showToast() {
      var t = document.getElementById('copyToast'); t.classList.add('show');
      setTimeout(function() { t.classList.remove('show'); }, 2500);
    }
  </script>

  <script type="module">
    import { initializeApp, getApps, getApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getAuth, onAuthStateChanged }     from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
    import { getRole, getRoleLabel, canAccess, canViewSheets, canViewAllSubmissions, CONTENT_CONFIG } from './roles.js';

    const cfg = { apiKey:'AIzaSyBRKBzxTYzBnBHo-YY8fSxTSSkM3uyujmc', authDomain:'ithelpsite-4ec53.firebaseapp.com', projectId:'ithelpsite-4ec53', storageBucket:'ithelpsite-4ec53.firebasestorage.app', messagingSenderId:'893459212285', appId:'1:893459212285:web:194adf30886cbb28c21b94' };
    const auth = getAuth(getApps().length ? getApp() : initializeApp(cfg));

    onAuthStateChanged(auth, user => {
      if (!user || !user.email.endsWith('@rowecasaorganics.com')) return;
      const email = user.email;
      const role  = getRole(email);

      const badge = document.getElementById('roleBadge');
      if (badge && role === 'it_admin') { badge.textContent = getRoleLabel(email); badge.dataset.role = role; }

      const cf = document.getElementById('contactFrom');
      if (cf && !cf.value) cf.value = email;

      let surveysVisible = 0, formsVisible = 0;
      document.querySelectorAll('[data-content-id]').forEach(card => {
        const id  = card.dataset.contentId;
        const c   = [...CONTENT_CONFIG.surveys, ...CONTENT_CONFIG.forms].find(x => x.id === id);
        if (!c) return;
        const show = canAccess(email, id);
        card.style.display = show ? '' : 'none';
        if (show && CONTENT_CONFIG.surveys.some(s => s.id === id)) surveysVisible++;
        if (show && CONTENT_CONFIG.forms.some(f => f.id === id))   formsVisible++;
      });

      document.getElementById('surveysAccessNotice')?.classList.toggle('show', surveysVisible === 0);
      document.getElementById('formsAccessNotice')?.classList.toggle('show', formsVisible === 0);

      if (canViewSheets(email)) {
        const sg = document.getElementById('sheetLinksRow-surveys');
        const fg = document.getElementById('sheetLinksRow-forms');
        if (sg) { sg.classList.add('visible'); sg.style.display = ''; }
        if (fg) { fg.classList.add('visible'); fg.style.display = 'none'; }
        document.querySelectorAll('.completed-sheet-link').forEach(a => a.classList.add('visible'));
      }
      if (canViewAllSubmissions(email)) document.getElementById('submissionsToggle')?.classList.add('visible');

      window._userEmail             = email;
      window._userRole              = role;
      window._canViewSheets         = canViewSheets(email);
      window._canViewAllSubmissions = canViewAllSubmissions(email);
      window._contentConfig         = CONTENT_CONFIG;

      if (typeof window.renderSubFilters === 'function') window.renderSubFilters(window._typeTab || 'surveys');
      document.getElementById('authLoading')?.classList.add('hidden');
    });
  </script>

  <script type="module" src="app.js"></script>
</body>
</html>
